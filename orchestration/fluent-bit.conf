[SERVICE]
    Flush         5
    Daemon        off
    Log_Level     info
    Parsers_File  parsers.conf

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*-json.log
    Parser            docker
    Tag               docker.*
    Refresh_Interval  5
    Mem_Buf_Limit     50MB
    Skip_Long_Lines   On

[FILTER]
    Name                modify
    Match               docker.*
    Add                 hostname ${HOSTNAME}
    Add                 environment staging

# Output configuration
# AWS (default): CloudWatch Logs
[OUTPUT]
    Name                cloudwatch_logs
    Match               docker.*
    region              ${AWS_REGION}
    log_group_name      /staging/containers
    log_stream_name     ${HOSTNAME}-%Y-%m-%d
    auto_create_group   On

# Fallback / OCI: also send to stdout so logs are still visible locally
[OUTPUT]
    Name   stdout
    Match  docker.*
    Format json_lines

# Option 3: Output to Elasticsearch (uncomment and configure)
# [OUTPUT]
#     Name  es
#     Match docker.*
#     Host  ${ELASTICSEARCH_HOST}
#     Port  9200
#     Index staging-logs
#     Type  _doc

# Option 4: Output to HTTP endpoint (uncomment and configure)
# [OUTPUT]
#     Name  http
#     Match docker.*
#     Host  ${LOG_AGGREGATOR_HOST}
#     Port  443
#     URI   /logs
#     Format json

